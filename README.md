# 航线可视化工具

一个基于 Streamlit 的交互式航线数据分析和可视化工具，支持多航司数据导入、筛选、地图展示和 HTML 导出功能。

## 🚀 核心特性

### 📊 多数据源支持
- 可同时加载多个 Excel / CSV 文件
- 支持文件上传功能，导入后自动合并数据
- 智能解析航线格式：`深圳(SZX)-德里(DEL)`

### 🔍 交互式筛选
- **航司筛选**：按航空公司过滤数据
- **始发地/目的地筛选**：按城市或机场代码筛选
- **机型筛选**：按飞机型号筛选
- **方向筛选**：出口/进口航线分类
- **实时更新**：筛选条件变化时地图自动刷新

### 🗺️ 地图可视化
- 基于 Folium 的交互式地图
- 航线标记点击显示详细信息
- 不同颜色区分出口/进口航线
- 悬停提示显示航班基本信息

### 📤 导出功能
- **HTML 地图导出**：离线查看和分享
- **Excel 数据导出**：筛选后的数据表格
- 一键导出，方便存档和报告

## 📁 项目结构

```
D:\flight_tool\
│
├─ data\                        # 航司数据文件夹
│    ├─ 示例数据_顺丰航空.xlsx    # 示例数据文件
│    └─ ...                     # 其他航司数据文件
│
├─ parser.py                    # 数据解析模块
├─ web_app.py                   # Streamlit 主程序
├─ requirements.txt             # Python 依赖包
├─ start.bat                    # Windows 启动脚本
└─ README.md                    # 项目说明文档
```

## 🛠️ 安装步骤

### 方法一：使用启动脚本（推荐）

1. **双击运行 `start.bat`**
   - 自动创建虚拟环境
   - 自动安装依赖包
   - 自动启动应用

### 方法二：手动安装

1. **创建虚拟环境**
   ```cmd
   D:
   cd D:\flight_tool
   "%Python312%\python.exe" -m venv venv
   ```

2. **激活虚拟环境**
   ```cmd
   D:\flight_tool\venv\Scripts\activate
   ```

3. **安装依赖包**
   ```cmd
   pip install -r requirements.txt
   ```

4. **启动应用**
   ```cmd
   streamlit run web_app.py
   ```

## 📋 数据格式要求

### Excel/CSV 文件必须包含以下列：

| 列名 | 说明 | 示例 |
|------|------|------|
| 航司 | 航空公司名称 | 顺丰航空 |
| 注册号（REG） | 飞机注册号 | B-208F |
| 机型 | 飞机型号 | B767-300F |
| 机龄 | 飞机使用年限 | 8年 |
| 出口航线 | 出口方向航线 | 深圳(SZX)-德里(DEL) |
| 出口飞行时长 | 出口飞行时间 | 6小时30分 |
| 出口飞行距离 | 出口飞行距离 | 4200公里 |
| 进口航线 | 进口方向航线 | 德里(DEL)-深圳(SZX) |
| 进口飞行时长 | 进口飞行时间 | 6小时45分 |
| 进口飞行距离 | 进口飞行距离 | 4200公里 |
| 特殊运营情况 | 备注信息 | 正常运营 |

### 航线格式说明
- **标准格式**：`城市名(IATA代码)-城市名(IATA代码)`
- **示例**：`深圳(SZX)-德里(DEL)`、`北京(PEK)-纽约(JFK)`
- **支持多段**：`深圳(SZX)-迪拜(DXB)-伦敦(LHR)`

## 🎯 使用方法

### 1. 准备数据
- 将航司数据文件放入 `D:\flight_tool\data` 文件夹
- 或通过 Web 界面上传文件

### 2. 启动应用
- 双击 `start.bat` 或手动运行 `streamlit run web_app.py`
- 浏览器自动打开应用界面

### 3. 数据筛选
- 使用左侧边栏的筛选条件
- 实时查看筛选结果和统计信息

### 4. 地图查看
- 点击地图标记查看航班详情
- 不同颜色表示不同方向（蓝色=出口，红色=进口）

### 5. 导出数据
- 点击"导出当前地图为 HTML"保存地图
- 点击"导出筛选数据为 Excel"保存数据表格

## ⚠️ 注意事项

### 环境要求
- **Python 版本**：3.8 或以上
- **操作系统**：Windows 10/11（脚本针对 Windows 优化）
- **浏览器**：Chrome、Firefox、Edge 等现代浏览器

### 性能建议
- 单个文件建议不超过 10,000 条记录
- 同时加载文件数量建议不超过 20 个
- 大数据量时可能需要等待几秒钟加载

### 常见问题

**Q: 启动失败，提示找不到 Python？**
A: 请确保已安装 Python 3.8+ 并设置环境变量 `%Python312%`

**Q: 数据加载失败？**
A: 检查 Excel/CSV 文件是否包含必需的列名，确保文件编码为 UTF-8

**Q: 地图显示空白？**
A: 确保网络连接正常，Folium 需要加载在线地图瓦片

**Q: 导出的 HTML 文件很大？**
A: 这是正常现象，HTML 文件包含完整的地图数据和样式

## 🔧 技术栈

- **前端框架**：Streamlit
- **地图可视化**：Folium
- **数据处理**：Pandas
- **文件处理**：openpyxl
- **开发语言**：Python 3.8+

## 📈 版本历史

### v1.0 (当前版本)
- ✅ 多航司数据导入和合并
- ✅ 交互式筛选功能
- ✅ Folium 地图可视化
- ✅ HTML 和 Excel 导出
- ✅ 响应式 Web 界面

## 🤝 技术支持

如遇到问题或需要功能扩展，请检查：
1. 数据文件格式是否正确
2. Python 环境是否配置正确
3. 依赖包是否安装完整
4. 网络连接是否正常

---

**航线可视化工具 v1.0** | 支持多航司数据分析与可视化