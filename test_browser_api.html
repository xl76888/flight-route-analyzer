<!DOCTYPE html>
<html>
<head>
    <title>Google Maps API æµ‹è¯•</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        #map { height: 400px; width: 100%; margin: 20px 0; }
        .status { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background-color: #d4edda; color: #155724; }
        .error { background-color: #f8d7da; color: #721c24; }
        .info { background-color: #d1ecf1; color: #0c5460; }
    </style>
</head>
<body>
    <h1>ğŸ—ºï¸ Google Maps API è¿æ¥æµ‹è¯•</h1>
    
    <div id="status" class="status info">
        ğŸ“¡ æ­£åœ¨æµ‹è¯• Google Maps API è¿æ¥...
    </div>
    
    <div id="map"></div>
    
    <div id="details">
        <h3>ğŸ“Š æµ‹è¯•è¯¦æƒ…</h3>
        <ul id="test-results"></ul>
    </div>

    <script>
        const API_KEY = 'AIzaSyBoAqo1lCI2FAQIY7A0jTlXI79mC2SO4Kw'; // å®é™…APIå¯†é’¥
        const MAP_ID = '45c4f1595b0cd27f9feda952';
        
        function addTestResult(message, isSuccess = true) {
            const ul = document.getElementById('test-results');
            const li = document.createElement('li');
            li.innerHTML = `${isSuccess ? 'âœ…' : 'âŒ'} ${message}`;
            li.style.color = isSuccess ? '#155724' : '#721c24';
            ul.appendChild(li);
        }
        
        function updateStatus(message, type = 'info') {
            const statusDiv = document.getElementById('status');
            statusDiv.className = `status ${type}`;
            statusDiv.innerHTML = message;
        }
        
        // æµ‹è¯•1: æ£€æŸ¥Google Maps APIè„šæœ¬åŠ è½½
        function testAPILoad() {
            return new Promise((resolve) => {
                const script = document.createElement('script');
                script.src = `https://maps.googleapis.com/maps/api/js?key=${API_KEY}&map_ids=${MAP_ID}&v=3.55`;
                
                script.onload = () => {
                    addTestResult('Google Maps API è„šæœ¬åŠ è½½æˆåŠŸ');
                    resolve(true);
                };
                
                script.onerror = () => {
                    addTestResult('Google Maps API è„šæœ¬åŠ è½½å¤±è´¥', false);
                    resolve(false);
                };
                
                document.head.appendChild(script);
            });
        }
        
        // æµ‹è¯•2: åˆå§‹åŒ–åœ°å›¾
        function testMapInit() {
            try {
                const map = new google.maps.Map(document.getElementById('map'), {
                    center: { lat: 39.9042, lng: 116.4074 }, // åŒ—äº¬
                    zoom: 10,
                    mapId: MAP_ID
                });
                
                addTestResult('åœ°å›¾åˆå§‹åŒ–æˆåŠŸ');
                
                // æ·»åŠ æ ‡è®°æµ‹è¯•
                const marker = new google.maps.Marker({
                    position: { lat: 39.9042, lng: 116.4074 },
                    map: map,
                    title: 'æµ‹è¯•æ ‡è®°'
                });
                
                addTestResult('åœ°å›¾æ ‡è®°æ·»åŠ æˆåŠŸ');
                return true;
            } catch (error) {
                addTestResult(`åœ°å›¾åˆå§‹åŒ–å¤±è´¥: ${error.message}`, false);
                return false;
            }
        }
        
        // ä¸»æµ‹è¯•æµç¨‹
        async function runTests() {
            try {
                updateStatus('ğŸ”„ æ­£åœ¨åŠ è½½ Google Maps API...', 'info');
                
                const apiLoaded = await testAPILoad();
                
                if (apiLoaded && typeof google !== 'undefined') {
                    updateStatus('ğŸ”„ æ­£åœ¨åˆå§‹åŒ–åœ°å›¾...', 'info');
                    
                    // ç­‰å¾…APIå®Œå…¨åŠ è½½
                    setTimeout(() => {
                        const mapInitialized = testMapInit();
                        
                        if (mapInitialized) {
                            updateStatus('ğŸ‰ Google Maps API æµ‹è¯•æˆåŠŸï¼æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚', 'success');
                        } else {
                            updateStatus('âš ï¸ APIåŠ è½½æˆåŠŸï¼Œä½†åœ°å›¾åˆå§‹åŒ–å¤±è´¥ã€‚', 'error');
                        }
                    }, 1000);
                } else {
                    updateStatus('âŒ Google Maps API åŠ è½½å¤±è´¥ã€‚è¯·æ£€æŸ¥ç½‘ç»œè¿æ¥å’ŒAPIå¯†é’¥ã€‚', 'error');
                }
            } catch (error) {
                updateStatus(`âŒ æµ‹è¯•è¿‡ç¨‹ä¸­å‘ç”Ÿé”™è¯¯: ${error.message}`, 'error');
                addTestResult(`æµ‹è¯•å¼‚å¸¸: ${error.message}`, false);
            }
        }
        
        // é¡µé¢åŠ è½½å®Œæˆåå¼€å§‹æµ‹è¯•
        document.addEventListener('DOMContentLoaded', runTests);
    </script>
</body>
</html>